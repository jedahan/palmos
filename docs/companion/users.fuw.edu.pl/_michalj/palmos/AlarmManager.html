<html>
<!-- Mirrored from users.fuw.edu.pl/~michalj/palmos/AlarmManager.html by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 17 Feb 2015 19:10:01 GMT -->
<head><title>Alarm Manager</title></head><body bgcolor="#ffffff"><TABLE WIDTH="100%">  <TR>    <TD WIDTH=25%><a href="MiscUI.html"><IMG SRC="images/prev.html" BORDER=0 ALT="Previous Page"></TD>    <TD WIDTH=25%><a href="ReferenceTOC.html"><IMG SRC="images/content.gif" BORDER=0 ALT="Table of Contents"></TD>    <TD WIDTH=25%><a href="ReferenceIX.html"><IMG SRC="images/index.gif" BORDER=0 ALT="Index"></TD>    <TD WIDTH=25%><a href="Bitmap.html"><IMG SRC="images/next.html" BORDER=0 ALT="Next Page"></TD>  </TR></TABLE><br><center><B>Palm OS SDK Reference</B></center><hr><br><a name="924905"> </a><h1><IMG SRC="images/PCPplain.gif" ALT="Palm Logo" WIDTH="45" HEIGHT="44"> <a name="924903"> </a>23 Alarm Manager</h1><dl><a name="924907"> </a><p></p><dt>This chapter provides reference material for the alarm manager:<ul type="SQUARE"><a name="924911"> </a><br><li><a href="AlarmManager.html#924923">Alarm Manager Functions</a><br><a name="924915"> </a><br><li><a href="AlarmManager.html#925049">Application-Defined Functions</a><br></ul><a name="924917"> </a><p></p><dt>The alarm manager API is declared in the header file <code>AlarmMgr.h</code>. <a name="924918"> </a><p></p><dt>For more information on the alarm manager, see the section <a href="SystemFeatures.html#924958">"Alarms"</a> in the <em>Palm OS Programmer's Companion</em>. </dl><a name="924923"> </a><h2> Alarm Manager Functions</h2><a name="924926"> </a><br> <br> <br><h3> AlmGetAlarm</h3><dl><dl><a name="924927"> </a><h4>Purpose </h4><dl><a name="924928"> </a><p></p><dt>Return the date and time for the application's alarm, if one is set. </dl><a name="924929"> </a><h4>Prototype </h4><dl><a name="924931"> </a><dt><code>UInt32 AlmGetAlarm (UInt16&nbsp;cardNo, LocalID&nbsp;dbID, UInt32*&nbsp;refP)</code></dl></dl><dl><a name="924932"> </a><h4>Parameters </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924933"> </a><CODE>-&gt; <code>cardNo</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Number of the storage card on which the application resides.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924934"> </a><CODE>-&gt; <code>dbID</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Local ID of the application.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924935"> </a><CODE>&lt;- <code>refP</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>The alarm's reference value is returned here. This value is passed to the application when the alarm is triggered. <br></TD></TR></TABLE></dl><dl><a name="924936"> </a><h4>Result </h4><dl><a name="924937"> </a><p></p><dt>The date and time the alarm will trigger, given in seconds since 1/1/1904; if no alarm is active for the application, 0 is returned for the alarm seconds and the reference value is undefined.</dl></dl><dl><a name="924938"> </a><h4>See Also </h4><dl><a name="924942"> </a><p></p><dt><code><a href="AlarmManager.html#924970"></code>AlmSetAlarm<code></a></code> </dl></dl></dl><a name="924945"> </a><br> <br> <br><h3> AlmGetProcAlarm</h3><dl><dl><a name="924946"> </a><h4>Purpose </h4><dl><a name="924947"> </a><p></p><dt>Macro that returns the date and time that a procedure alarm will trigger. Also returns the caller-defined alarm reference value. </dl><a name="924948"> </a><h4>Prototype </h4><dl><a name="924949"> </a><dt><code>AlmGetProcAlarm (procP, refP)</code></dl></dl><dl><a name="924950"> </a><h4>Parameters </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924951"> </a><CODE>-&gt;<code> procP</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Pointer to a function that will be called when alarm is triggered. See <code><a href="AlarmManager.html#925052"></code>AlmAlarmProcPtr<code></a></code>. <br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924955"> </a><CODE>&lt;-<code> refP</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>A <code>UInt32</code> pointer to a location where the alarm's reference value is returned. This value is passed to the procedure when the alarm is triggered. <br></TD></TR></TABLE></dl><dl><a name="924956"> </a><h4>Result </h4><dl><a name="924957"> </a><p></p><dt>The date and time the alarm will trigger, given in seconds since 1/1/1904; if no alarm is active for the procedure, 0 is returned for the alarm seconds and the reference value is undefined. </dl></dl><dl><a name="924958"> </a><h4>Compatibility </h4><dl><a name="924962"> </a><p></p><dt>Implemented only if <a href="CompatibilityApdx.html#484253">3.2 New Feature Set</a> is present.</dl><a name="924963"> </a><h4>See Also </h4><dl><a name="924967"> </a><p></p><dt><code><a href="AlarmManager.html#925011"></code>AlmSetProcAlarm<code></a></code> </dl></dl></dl><a name="924970"> </a><br> <br> <br><h3> AlmSetAlarm</h3><dl><dl><a name="924971"> </a><h4>Purpose </h4><dl><a name="924973"> </a><p></p><dt>Set or cancel an alarm for the given application.</dl><a name="924974"> </a><h4>Prototype </h4><dl><a name="924976"> </a><dt><code>Err AlmSetAlarm (UInt16&nbsp;cardNo, LocalID&nbsp;dbID, UInt32&nbsp;ref, UInt32&nbsp;alarmSeconds, Boolean&nbsp;quiet)</code></dl></dl><dl><a name="924977"> </a><h4>Parameters </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924978"> </a><CODE>-&gt; <code>cardNo</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Number of the storage card on which the application resides.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924979"> </a><CODE>-&gt; <code>dbID</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Local ID of the application.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924980"> </a><CODE>-&gt; <code>ref</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Caller-defined value. This value is passed with the launch code that notifies the application that the alarm has been triggered.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924981"> </a><CODE>-&gt; <code>alarmSeconds</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Alarm date/time in seconds since 1/1/1904, or 0 to cancel the current alarm (if any).<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924982"> </a><CODE>-&gt; <code>quiet</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Reserved for future upgrade. This value is not currently used.<br></TD></TR></TABLE></dl><dl><a name="924983"> </a><h4>Result </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924984"> </a><CODE><code>0</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>No error.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924986"> </a><CODE><code>almErrMemory</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Insufficient memory.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="924988"> </a><CODE><code>almErrFull</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Alarm table is full.<br></TD></TR></TABLE></dl><dl><a name="924989"> </a><h4>Comments </h4><dl><a name="924990"> </a><p></p><dt>This function sets an alarm for the specified application. An application can have only one alarm set at a time. If an alarm for this application has already been set, it is replaced with the new alarm.<a name="924991"> </a><p></p><dt>The <code>alarmSeconds</code> parameter specifies the time at which the alarm will be triggered. As soon as possible after this time, the alarm manager sends the <code><a href="AppLaunchCodes.html#925171"></code>sysAppLaunchCmdAlarmTriggered<code></a></code> launch code to the specified application. If there is another alarm that should be set for this application, you can set it in response to this launch code. Following the <code>sysAppLaunchCmdAlarmTriggered</code> launch code, the alarm manager sends a <code><a href="AppLaunchCodes.html#925209"></code>sysAppLaunchCmdDisplayAlarm<code></a></code> launch code. This is where your application should do things such as display a modal dialog indicating that the event has occurred. Read more about these launch codes in <a href="AppLaunchCodes.html#924904">Chapter 1, "Application Launch Codes."</a><a name="925003"> </a><p></p><dt>If your application needs access to any particular value to respond to the alarm, pass a pointer to that value in the <code>ref</code> parameter. The system will pass this pointer back to the application in the launch codes' parameter blocks. </dl><a name="925004"> </a><h4>See Also </h4><dl><a name="925008"> </a><p></p><dt><code><a href="AlarmManager.html#924926"></code>AlmGetAlarm<code></a></code> </dl></dl></dl><a name="925011"> </a><br> <br> <br><h3> AlmSetProcAlarm</h3><dl><dl><a name="925012"> </a><h4>Purpose </h4><dl><a name="925014"> </a><p></p><dt>Macro that sets or cancels a procedure alarm.</dl><a name="925015"> </a><h4>Prototype </h4><dl><a name="925016"> </a><dt><code>AlmSetProcAlarm (procP, ref, alarmSeconds)</code></dl></dl><dl><a name="925017"> </a><h4>Parameters </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925018"> </a><CODE>-&gt; <code>procP</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Pointer to a function that should be called when alarm is triggered. See <code><a href="AlarmManager.html#925052"></code>AlmAlarmProcPtr<code></a></code>. <br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925022"> </a><CODE>-&gt; <code>ref</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>A caller-defined <code>UInt32</code> value. This value is passed with the launch code that notifies the application that the alarm has been triggered.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925023"> </a><CODE>-&gt; <code>alarmSeconds</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>A <code>UInt32</code> indicating the alarm date/time in seconds since 1/1/1904, or 0 to cancel the current alarm (if any).<br></TD></TR></TABLE></dl><dl><a name="925024"> </a><h4>Result </h4><dl><a name="925025"> </a><p></p><dt>Returns one of the following error codes:<TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925026"> </a><CODE><code>0</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>No error.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925028"> </a><CODE><code>almErrMemory</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Insufficient memory.<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925030"> </a><CODE><code>almErrFull</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Alarm table is full.<br></TD></TR></TABLE></dl></dl><dl><a name="925031"> </a><h4>Comments </h4><dl><a name="925035"> </a><p></p><dt>This macro is similar to the <code><a href="AlarmManager.html#924970"></code>AlmSetAlarm<code></a></code> function, but it specifies a procedure to be called at the specified date and time rather than an application to be launched. With this macro, you can set alarms that are independent of any application. For example, a shared library can set procedure alarms that call a procedure implemented in the library. <a name="925036"> </a><p></p><dt>Procedure alarms also differ from regular system alarms in that if they trigger when the device is in sleep mode, the LCD does not light up. Thus, you can use procedure alarms to perform a scheduled task in a manner that is entirely hidden from the user. <a name="925037"> </a><blockquote><br><hr><br><em><strong>IMPORTANT:  </strong></em>Because the <code>procP</code> pointer is used to directly call the procedure, the pointer must remain valid from the time <code>AlmSetProcAlarm</code> is called to the time the alarm is triggered. If the procedure is in a shared library, you must keep the library open. If the procedure is in a separately loaded code resource, the resource must remain locked until the alarm is triggered. When you close a library or unlock a resource, you must remove any pending alarms. If you don't, the system will crash when the alarm is triggered. <br><hr><br></blockquote></dl><a name="925038"> </a><h4>Compatibility </h4><dl><a name="925042"> </a><p></p><dt>Implemented only if <a href="CompatibilityApdx.html#484253">3.2 New Feature Set</a> is present.</dl><a name="925043"> </a><h4>See Also </h4><dl><a name="925047"> </a><p></p><dt><code><a href="AlarmManager.html#924945"></code>AlmGetProcAlarm<code></a></code> </dl></dl></dl><a name="925049"> </a><h2> Application-Defined Functions</h2><a name="925052"> </a><br> <br> <br><h3> AlmAlarmProcPtr</h3><dl><dl><a name="925053"> </a><h4>Purpose </h4><dl><a name="925054"> </a><p></p><dt>A procedure to be executed when an alarm is triggered.</dl><a name="925055"> </a><h4>Prototype </h4><dl><a name="925056"> </a><dt><code>void (*AlmAlarmProcPtr) (UInt16&nbsp;almProcCmd, SysAlarmTriggeredParamType&nbsp;*paramP)</code></dl></dl><dl><a name="925057"> </a><h4>Parameters </h4><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925059"> </a><CODE><code>-&gt; almProcCmd</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>One of the <code>AlmProcCmdEnum</code> constants. These are commands that your function must handle. Possible values are:<br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=35% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=25% VALIGN=TOP ALIGN=LEFT><a name="925061"> </a><CODE><code>almProcCmdTriggered</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>The alarm's date and time has passed and the alarm has been triggered. The function should perform its main task in response to this command. <br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=35% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=25% VALIGN=TOP ALIGN=LEFT><a name="925063"> </a><CODE>almProcCmdReschedule</CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>A system time change occurred, so the function must reschedule the alarm. <br></TD></TR></TABLE><TABLE WIDTH=95%><TR><TD WIDTH=5% VALIGN=TOP ALIGN=RIGHT>&nbsp</TD><TD WIDTH=30% VALIGN=TOP ALIGN=LEFT><a name="925064"> </a><CODE><code>-&gt; paramP</code></CODE><br></TD><TD WIDTH=* VALIGN=TOP ALIGN=LEFT>Pointer to a <code>SysAlarmTriggeredParamType</code> structure. See below. <br></TD></TR></TABLE></dl><dl><a name="925065"> </a><h4>Result </h4><dl><a name="925066"> </a><p></p><dt>Returns nothing. </dl></dl><dl><a name="925067"> </a><h4>Comments </h4><dl><a name="925068"> </a><p></p><dt><code>AlmAlarmProcPtr</code> procedures are called when an alarm set by <code><a href="AlarmManager.html#925011"></code>AlmSetProcAlarm<code></a></code> is triggered. Your implementation should check the value of <code>almProcCmd</code> and respond accordingly. <a name="925072"> </a><p></p><dt>The <code>paramP</code> parameter is a pointer to a <code>SysAlarmTriggeredParamType</code> structure. This structure is defined as: </dl></dl><dl><a name="925073"> </a><br><code>typedef struct SysAlarmTriggeredParamType {</code><br></dl><dl><a name="925074"> </a><code>&nbsp&nbsp&nbsp UInt32	 	 	 	 ref;</code><br><a name="925075"> </a><code>&nbsp&nbsp&nbsp UInt32	 	 	 	 alarmSeconds;</code><br><a name="925076"> </a><code>&nbsp&nbsp&nbsp Boolean	 	 	 	 purgeAlarm;<br>} SysAlarmTriggeredParamType;</code><br><dl><a name="925078"> </a><p></p><dt><code>ref</code> and <code>alarmSeconds</code> are both values specified in <code><a href="AlarmManager.html#925011"></code>AlmSetProcAlarm<code></a></code> when the alarm is set. The <code>purgeAlarm</code> field specifies if the alarm will be removed from the alarm table when the function returns so that the <code><a href="AppLaunchCodes.html#925209"></code>sysAppLaunchCmdDisplayAlarm<code></a></code> launch code is not triggered. This should be <code>true</code> for all procedure alarms; the alarm manager set it to <code>true</code> for you after your function returns. <a name="925085"> </a><p></p><dt>If necessary, you can define new values for the <code>almProcCmd</code> parameter to call the procedure for something other than a triggered alarm or a system time change. The value you use must be greater than the constant <code>almProcCmdCustom</code> as defined in <code>AlarmMgr.h</code>. </dl></dl><dl><a name="925087"> </a><h4>Compatibility </h4><dl><a name="925091"> </a><p></p><dt>Implemented only if <a href="CompatibilityApdx.html#484253">3.2 New Feature Set</a> is present.</dl><a name="925092"> </a><h4>See Also </h4><dl><a name="925096"> </a><p></p><dt><code><a href="AlarmManager.html#924945"></code>AlmGetProcAlarm<code></a></code> <p><a name="925104"> </a> <strong></strong></p></dl></dl></dl><hr><br><center><B>Palm OS SDK Reference</B></center><br><TABLE WIDTH="100%">  <TR>    <TD WIDTH=10%>&nbsp</TD>    <TD WIDTH=20%><a href="MiscUI.html"><IMG SRC="images/prev.html" BORDER=0 ALT="Previous Page"></TD>    <TD WIDTH=20%><a href="ReferenceTOC.html"><IMG SRC="images/content.gif" BORDER=0 ALT="Table of Contents"></TD>    <TD WIDTH=20%><a href="ReferenceIX.html"><IMG SRC="images/index.gif" BORDER=0 ALT="Index"></TD>    <TD WIDTH=20%><a href="Bitmap.html"><IMG SRC="images/next.html" BORDER=0 ALT="Next Page"></TD>    <TD WIDTH=10%>&nbsp</TD>  </TR></TABLE><br><small><em>This is page 25 of 85 in this book</em></small><hr><br><address><a href="http://www.palmos.com/dev/">Palm Computing Platform Development Zone</a></address><i>Copyright &#169; 2000, Palm, Inc.   All rightsreserved.</i><!-- This file was created with Quadralay WebWorks Publisher 5.0.2 --><!-- --><!-- For more information on how this document, and how the rest of --><!-- this server was created, email devsupp@palm.com --><!-- --><!-- Last updated: 03/27/00 21:28:27 --></body>
<!-- Mirrored from users.fuw.edu.pl/~michalj/palmos/AlarmManager.html by HTTrack Website Copier/3.x [XR&CO'2013], Tue, 17 Feb 2015 19:10:01 GMT -->
</html>